# 收费系统协议

## 基本信息

端口号：8010
RedisDB：8

## 协议内容

### 根据处方生成收费订单

```http
[POST]/charge_order_service/drug/order/prescription
```

说明：
1. 根据处方信息生成收费单。
2. 如果处方中的多个医嘱的收费类别不是同一个运营机构的，不允许生成收费订单。
3. 药品医嘱信息为，单行医嘱信息的拼接信息。

#### 修改更新记录

| 对应业务      | 说明   |
| --------- | ---- |
| WEBV1.3.2 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名             | 类型         | 必填   | 说明                  |
| --------------- | ---------- | ---- | ------------------- |
| trad_amount     | Integer    | 是    | 收费单金额，单位分           |
| trad_toller     | Long       | 是    | 收费单发起人              |
| prescription_id | Long       | 是    | 处方ID                |
| patient_id      | Long       | 是    | 患者ID                |
| tenant_id       | Long       | 是    | 租户ID                |
| orders          | ObjectList | 是    | 药品医嘱列表              |
| validity_time   | Integer    | 是    | 收费单有效期，这时间内收费有效，单位秒 |

##### 药品医嘱列表

| 参数名        | 类型      | 必填   | 说明       |
| ---------- | ------- | ---- | :------- |
| orde_id    | Long    | 是    | 医嘱ID     |
| drug_id    | Long    | 是    | 药品ID     |
| drug_name  | String  | 是    | 药品名称     |
| drug_text  | String  | 是    | 药品医嘱信息   |
| drug_num   | Integer | 是    | 数量       |
| drug_unit  | String  | 是    | 单位       |
| drug_price | Integer | 是    | 药品单价,单位分 |
| char_id    | Long    | 是    | 收费类别ID   |

#### 回复报文参数

| 参数名           | 类型       | 必填   | 说明               |
| ------------- | -------- | ---- | ---------------- |
| trad_id       | Long     | 是    | 收费订单ID           |
| trad_item_ids | LongList | 是    | 收费订单子ID          |
| trad_amount   | Integer  | 是    | 收费总金额,单位分，计算得出的值 |

### 根据处方生成退费订单

```http
[POST]/charge_order_service/drug/order/prescription/refund
```

说明：
1. 只有原处方对应的收费单状态是交易成功的才创建退费订单，否则关闭交易即可。

#### 修改更新记录

| 对应业务      | 说明   |
| --------- | ---- |
| WEBV1.3.2 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名           | 类型     | 长度   | 必填   | 说明                          |
| ------------- | ------ | ---- | ---- | --------------------------- |
| pres_id       | Long   |      | 是    | 处方ID                        |
| is_refund     | Boolen |      | 是    | 是否退费，true表示退费，false表示接口补偿删除 |
| refund_reason | String | 64   | 否    | 退费理由                        |

#### 回复报文参数

| 参数名            | 类型      | 必填   | 说明                                       |
| -------------- | ------- | ---- | ---------------------------------------- |
| trad_id        | Long    | 是    | 收费订单ID                                   |
| trad_state     | Integer | 是    | 收费订单新状态；1:交易未创建;2:交易已创建等待付款;3:交易关闭;4:交易成功;5:超时失效。 |
| refund_trad_id | Long    | 否    | 退费订单ID                                   |

## 其他收费


### 门诊其它费用新增修改

```http
[POST]/charge_order_service/other/fee/{other_fee_id}
```

说明：
1、other_fee_id 其它费用ID 为空时新增，不为空时修改

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

其他收费表(com_other_fee)

#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### PathVariable

| 参数名          | 类型   | 必填   | 说明           |
| ------------ | ---- | ---- | ------------ |
| other_fee_id | Long | 否    | 收费ID,当更新时为必传 |

#### RequestBody

| 参数名              | 类型      | 必选   | 说明                  |
| ---------------- | ------- | ---- | ------------------- |
| other_fee_name   | String  | 是    | 收费名称    (注：长度最大30)  |
| other_fee_py     | String  | 否    | 名称简拼    (注：长度最大30)  |
| other_fee_price  | Double  | 是    | 其它费用价格,单位元          |
| other_fee_charge | Long    | 是    | 收费类别ID              |
| other_fee_enable | Integer | 是    | 是否有效,默认：1；0：停用；1：有效 |

#### 回复报文

| 参数名          | 类型   | 必选   | 说明     |
| ------------ | ---- | ---- | ------ |
| other_fee_id | Long | 是    | 其它费用ID |


### 门诊其它费用删除

```http
[DELETE]/charge_order_service/other/fee/{other_fee_id}
```

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

其他收费表(com_other_fee)

#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### PathVariable

| 参数名          | 类型   | 必填   | 说明   |
| ------------ | ---- | ---- | ---- |
| other_fee_id | Long | 是    | 收费ID |

#### 回复报文参数

| 参数名          | 类型   | 必填   | 说明   |
| ------------ | ---- | ---- | ---- |
| other_fee_id | Long | 是    | 收费ID |


### 门诊其它费用查询列表

```http
[GET]/charge_order_service/other/fee/list
```

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

其他收费表(com_other_fee)

#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### RequestParameter

| 参数名       | 类型      | 必选   | 说明              |
| --------- | ------- | ---- | --------------- |
| key       | String  | 否    | 收费名称            |
| enable    | Integer | 否    | 是否有效， 0：停用 1：有效 |
| page_num  | Integer | 否    | 页码 （默认为 1）      |
| page_size | Integer | 否    | 每页数量 （默认为 10）   |

#### 回复报文参数

| 参数名       | 类型         | 必填   | 说明     |
| --------- | ---------- | ---- | ------ |
| page_num  | Integer    | 是    | 页码     |
| page_size | Integer    | 是    | 每页数量   |
| pages     | Integer    | 是    | 总页数    |
| total     | Integer    | 是    | 总数量    |
| otherFees | ObjectList | 是    | 其它费用列表 |

#### 其它费用列表

| 参数名              | 类型      | 必填   | 说明                  |
| ---------------- | ------- | ---- | ------------------- |
| other_fee_id     | Long    | 是    | 其它收费ID              |
| other_fee_name   | String  | 是    | 收费名称                |
| other_fee_py     | String  | 否    | 名称简拼                |
| other_fee_price  | Integer | 是    | 其它费用价格,单位元          |
| other_fee_enable | Integer | 是    | 是否有效,默认：1；0：停用；1：有效 |


### 门诊收费待收费新增其它费用查询列表   

```http
[GET]/charge_order_service/other/fee/enable/add/list
```

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

其他收费表(com_other_fee)

#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |


#### 回复报文参数

| 参数名       | 类型         | 必填   | 说明     |
| --------- | ---------- | ---- | ------ |
| otherFees | ObjectList | 是    | 其它费用列表 |

#### 其它费用列表

| 参数名             | 类型     | 必填   | 说明         |
| --------------- | ------ | ---- | ---------- |
| other_fee_id    | Long   | 是    | 其它收费ID     |
| other_fee_name  | String | 是    | 收费名称       |
| other_fee_py    | String | 否    | 名称简拼       |
| other_fee_price | Double | 是    | 其它费用价格,单位元 |
| agenId          | Long   | 是    | 运营机构       |


### 门诊其它费用查询

```http
[GET]/charge_order_service/other/fee/{other_fee_id}
```

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

其他收费表(com_other_fee)

#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### PathVariable

| 参数名          | 类型   | 必填   | 说明   |
| ------------ | ---- | ---- | ---- |
| other_fee_id | Long | 是    | 收费ID |

#### 回复报文参数

| 参数名              | 类型      | 必填   | 说明                  |
| ---------------- | ------- | ---- | ------------------- |
| other_fee_id     | Long    | 是    | 收费ID                |
| other_fee_name   | String  | 是    | 收费名称    (注：长度最大30)  |
| other_fee_py     | String  | 否    | 名称简拼    (注：长度最大30)  |
| other_fee_price  | Double  | 是    | 其它费用价格,单位元          |
| other_fee_charge | Long    | 是    | 收费类别ID              |
| charge_name      | String  | 是    | 收费类别名称              |
| other_fee_enable | Integer | 是    | 是否有效,默认：1；0：停用；1：有效 |


### 根据其他费用生成收费单
```http
[POST]/charge_order_service/other/fee/order
```
| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.1.1 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

租户患者基本信息表(adm_patient)

收费类别表(com_charge_class)

租户配置表(tena_configure)

其他收费表(com_other_fee)



#### 请求报文参数

#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### RequestBody

| 参数名         | 类型         | 必填   | 说明        |
| ----------- | ---------- | ---- | --------- |
| trad_amount | Double     | 是    | 收费单金额，单位元 |
| other_fee   | ObjectList | 是    | 其他收费列表    |
| patient_id  | Long       | 是    | 患者ID      |
| agen_id     | Long       | 是    | 运营机构ID    |

#### 其他收费列表

| 参数名          | 类型      | 必填   | 说明     |
| ------------ | ------- | ---- | ------ |
| other_fee_id | Long    | 是    | 其他收费ID |
| num          | Integer | 是    | 收费项数量  |
#### 回复报文参数

| 参数名           | 类型       | 必填   | 说明               |
| ------------- | -------- | ---- | ---------------- |
| trad_ids      | LongList | 是    | 收费订单ID           |
| trad_item_ids | LongList | 是    | 收费订单子ID          |
| trad_amount   | Double   | 是    | 收费总金额,单位元，计算得出的值 |

### 显示当前患者待收费列表
```http
[GET]/charge_order_service/other/fee/order/list/{patient_id}/{agen_id}
```
| 对应业务        | 说明         |
| ----------- | ---------- |
| WEBV1.3.1.1 | 新增         |
| V1.3.4      | 修改 增加检查单支持 |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

租户患者基本信息表(adm_patient)

商品促销优惠子表(erp_goods_promoteitem)

商品促销优惠子表(erp_goods_promoteitem)

租户用户信息表(com_tena_user)



#### RequestHeader

| 参数名                 | 类型   | 必填   | 说明                 |
| ------------------- | ---- | ---- | ------------------ |
| Env.HEAD_TENANT_KEY | Long | 是    | 租户ID，实现值是：tenantId |

#### PathVariable

| 参数名        | 类型   | 必填   | 说明     |
| ---------- | ---- | ---- | ------ |
| patient_id | Long | 是    | 患者ID   |
| agen_id    | Long | 是    | 运营结构ID |

#### 回复报文参数

| 参数名            | 类型         | 必填   | 说明     |
| -------------- | ---------- | ---- | ------ |
| pati_id        | String     | 是    | 患者ID   |
| pati_name      | String     | 是    | 患者名字   |
| patient_gender | Integer    | 是    | 患者性别   |
| pati_age       | String     | 是    | 患者年龄   |
| pati_phone     | String     | 是    | 患者电话   |
| trad_time      | String     | 是    | 收费单时间  |
| list           | ObjectList | 是    | 待收费单列表 |

#### 待收费单列表

| 参数名              | 类型         | 必填   | 说明      |
| :--------------- | :--------- | :--- | :------ |
| trad_id          | String     | 是    | 收费单ID   |
| validity_time    | String     | 是    | 收费单有效期  |
| type_name        | String     | 是    | 收费单业务类型 |
| bill_maker       | String     | 是    | 开单医生姓名  |
| item_total_price | Double     | 是    | 小计，单位元  |
| list             | ObjectList | 是    | 子收费单列表  |

#### 子收费单列表

| 参数名              | 类型      | 必填   | 说明         |
| ---------------- | ------- | ---- | ---------- |
| item_id          | String  | 是    | 子收费单ID     |
| item_name        | String  | 是    | 收费项目名称     |
| item_unit        | String  | 否    | 单位         |
| item_price       | Double  | 否    | 单价,单位元     |
| item_count       | Integer | 是    | 数量         |
| item_total_price | Double  | 是    | 收费金额小计，单位元 |
| item_promote     | String  | 否    | 优惠信息       |


##检查套餐


###检查套餐费列表

```http
  [GET]/charge_order_service/examination_package/list
```

####修改更新记录

| 对应版本   | 说明   |
| ------ | ---- |
| V1.3.4 | 新增   |

#### 请求报文参数

##### RequestBody

| 参数名       | 类型      | 必填   | 说明          |
| --------- | ------- | ---- | ----------- |
| key       | String  | 否    | 套餐名称或拼音码    |
| page_size | Integer | 否    | 每页条数 空表示10条 |
| page_num  | Integer | 否    | 第几页 空表示第1页  |


#### 回复报文参数 

| 参数名       | 类型         | 必填   | 说明     |
| --------- | ---------- | ---- | ------ |
| page_num  | Integer    | 是    | 当前页    |
| page_size | Integer    | 是    | 每页的数量  |
| total     | Integer    | 是    | 总记录数   |
| pages     | Integer    | 是    | 总页数    |
| list      | ObjectList | 是    | 挂号套餐列表 |


检查套餐列表

| 参数名                | 类型      | 必填   | 说明          |
| ------------------ | ------- | ---- | ----------- |
| package_id         | String  | 是    | 套餐ID        |
| package_name       | String  | 是    | 套餐名称        |
| package_price      | Double  | 是    | 套餐组合价格      |
| package_real_price | Double  | 是    | 套餐价格        |
| bill_dept_name     | String  | 是    | 开单科室名称      |
| exe_dept_name      | String  | 是    | 执行科室名称      |
| package_enable     | Integer | 是    | 是否有效 0停用1有效 |



###检查套餐获取

```http
  [GET]/charge_order_service/examination_package/{package_id} 
```

处理说明：
如果该套餐对应的检查费子项对应的价格发生了变化，需要在错误信息（error_text）里说明

####修改更新记录

| 对应版本   | 说明   |
| ------ | ---- |
| V1.3.4 | 新增   |

#### 请求报文参数

 PathVariable

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| package_id | String | 是    | 套餐ID |


#### 回复报文参数 

| 参数名                 | 类型         | 必填   | 说明               |
| ------------------- | ---------- | ---- | ---------------- |
| package_id          | String     | 是    | 套餐ID             |
| package_name        | String     | 是    | 套餐名称             |
| package_py          | String     | 是    | 套餐简拼             |
| package_wb          | String     | 是    | 套餐简拼             |
| package_price       | Double     | 是    | 套餐组合价格           |
| package_real_price  | Double     | 是    | 套餐价格             |
| package_charge      | String     | 是    | 收费类别ID           |
| package_charge_name | String     | 是    | 收费类别名称           |
| bill_deptid         | String     | 是    | 开单科室id           |
| bill_deptname       | String     | 是    | 开单科室名称           |
| exe_deptid          | String     | 是    | 执行科室id           |
| exe_deptname        | String     | 是    | 执行科室名称           |
| package_rem         | String     | 是    | 备注               |
| package_enable      | Integer    | 是    | 是否有效 0停用1有效      |
| error_text          | Integer    | 否    | 错误信息 有表示检查单价格有变动 |
| list                | ObjectList | 是    | 检查费列表            |

error_text说明： 请看产品


检查费列表说明


| 参数名       | 类型      | 必填   | 说明                    |
| --------- | ------- | ---- | --------------------- |
| fee_type  | Integer | 是    | 表示来自哪种费用 0检查费用  2其他费用 |
| fee_id    | String  | 是    | 费用ID                  |
| fee_name  | String  | 是    | 费用名称                  |
| fee_price | Double  | 是    | 费用价格                  |
| fee_num   | Integer | 是    | 数量                    |




###检查套餐新增/修改

```http
  [POST]/charge_order_service/examination_package/{package_id}
```

处理说明：


####修改更新记录

| 对应版本   | 说明   |
| ------ | ---- |
| V1.3.4 | 新增   |

#### 请求报文参数

##### PathVariable

| 参数名        | 类型     | 必填   | 说明                 |
| ---------- | ------ | ---- | ------------------ |
| package_id | String | 否    | 套餐ID 有该值为修改，无该值为新增 |

##### RequestBody

| 参数名                | 类型         | 必填   | 说明          |
| ------------------ | ---------- | ---- | ----------- |
| package_name       | String     | 是    | 套餐名称        |
| package_py         | String     | 是    | 套餐简拼        |
| package_wb         | String     | 是    | 套餐简拼        |
| package_price      | Double     | 是    | 套餐组合价格      |
| package_real_price | Double     | 是    | 套餐价格        |
| package_charge     | String     | 是    | 收费类别ID      |
| bill_deptid        | String     | 是    | 开单科室id      |
| exe_deptid         | String     | 是    | 执行科室id      |
| package_rem        | String     | 是    | 备注          |
| package_enable     | Integer    | 是    | 是否有效 0停用1有效 |
| list               | ObjectList | 是    | 检查费列表       |



检查费列表说明

| 参数名      | 类型      | 必填   | 说明                    |
| -------- | ------- | ---- | --------------------- |
| fee_type | Integer | 是    | 表示来自哪种费用 0检查费用  2其他费用 |
| fee_id   | String  | 是    | 费用ID                  |
| fee_num  | Integer | 是    | 数量                    |




#### 回复报文参数 

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| package_id | String | 是    | 套餐ID |




###检查套餐删除

```http
  [DELETE]/charge_order_service/examination_package/{package_id} 
```


####修改更新记录

| 对应版本   | 说明   |
| ------ | ---- |
| V1.3.4 | 新增   |

#### 请求报文参数

 PathVariable

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| package_id | String | 是    | 套餐ID |



#### 回复报文参数 

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |



### 检查费/其他费列表

```http
[GET]/charge_order_service/examination_package/fee_options
```

说明：
 由检查费用和其他费用两个集合组成
 检查费在前，其他费用在后
 不包含停用的

#### 修改更新记录

| 对应业务   | 说明   |
| ------ | ---- |
| V1.3.4 | 新增   |


#### 请求报文参数


| 参数名  | 类型     | 必填   | 说明                       |
| ---- | ------ | ---- | ------------------------ |
| key  | String | 否    | 查询关键字 费用名称，拼音码，或五笔码 模糊匹配 |

#### 回复报文参数

检查费列表

| 参数名       | 类型      | 必填   | 说明                    |
| --------- | ------- | ---- | --------------------- |
| fee_type  | Integer | 是    | 表示来自哪种费用 0检查费用  2其他费用 |
| fee_id    | String  | 是    | 费用ID                  |
| fee_name  | String  | 是    | 费用名称                  |
| fee_price | Double  | 是    | 费用价格                  |


##检查处方生成收费/退费订单

### 根据检查处方生成收费订单

```http
[POST]/charge_order_service/examination/trade_submit
```

说明：
根据检查处方生成收费订单

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名            | 类型         | 必填   | 说明                  |
| -------------- | ---------- | ---- | ------------------- |
| exam_pack_list | ObjectList | 是    | 检查信息列表              |
| trad_toller    | Long       | 是    | 收费单发起人              |
| patient_id     | Long       | 是    | 患者ID                |
| tenant_id      | Long       | 是    | 租户ID                |
| validity_time  | Integer    | 是    | 收费单有效期，这时间内收费有效，单位秒 |

#####  检查信息列表

| 参数名         | 类型         | 必填   | 说明                                  |
| ----------- | ---------- | ---- | ----------------------------------- |
| trad_amount | Integer    | 是    | 收费单金额，单位分                           |
| info_id     | Long       | 是    | 检查信息ID 对应 trad_bizid                |
| biztype     | Integer    | 是    | 业务类型 6:门诊检查项; 7:门诊检查套餐; 8:门诊检查其他收费; |
| exam_list   | ObjectList | 是    | 检查单列表                               |


##### 检查单列表

| 参数名       | 类型      | 必填   | 说明                     |
| --------- | ------- | ---- | :--------------------- |
| info_id   | Long    | 是    | 检查套餐ID或者检查项目ID或者其它收费ID |
| info_name | String  | 是    | 检查套餐或者检查项或者其他收费的项目名称   |
| num       | Integer | 是    | 数量                     |
| price     | Integer | 是    | 单价,单位分                 |
| char_id   | Long    | 是    | 收费类别ID                 |


#### 回复报文参数ObjectList

| 参数名           | 类型       | 必填   | 说明               |
| ------------- | -------- | ---- | ---------------- |
| trad_id       | Long     | 是    | 收费订单ID           |
| trad_item_ids | LongList | 是    | 收费订单子ID          |
| trad_amount   | Integer  | 是    | 收费总金额,单位分，计算得出的值 |



### 根据检查处方生成退费订单

```http
[POST]/charge_order_service/examination/trade_refund
```

说明：
根据检查处方生成收费订单

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名           | 类型       | 必填   | 说明    |
| ------------- | -------- | ---- | ----- |
| refund_reason | String   | 64   | 否     |
| exam_list     | LongList | 是    | 检查单列表 |


##### 检查单列表

| 参数名     | 类型   | 必填   | 说明                     |
| ------- | ---- | ---- | :--------------------- |
| info_id | Long | 是    | 检查项目ID   对应 trad_bizid |


#### 回复报文参数ObjectList

| 参数名     | 类型   | 必填   | 说明     |
| ------- | ---- | ---- | ------ |
| trad_id | Long | 是    | 退费订单ID |



### 根据检查处方生成取消收费订单

```http
[POST]/charge_order_service/examination/trade_cancel
```

说明：
根据检查处方生成收费订单

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名           | 类型       | 必填   | 说明    |
| ------------- | -------- | ---- | ----- |
| refund_reason | String   | 64   | 否     |
| exam_list     | LongList | 是    | 检查单列表 |


##### 检查单列表

| 参数名     | 类型   | 必填   | 说明                     |
| ------- | ---- | ---- | :--------------------- |
| info_id | Long | 是    | 检查项目ID   对应 trad_bizid |


#### 回复报文参数ObjectList

| 参数名     | 类型   | 必填   | 说明     |
| ------- | ---- | ---- | ------ |
| trad_id | Long | 是    | 退费订单ID |


##微信端支付


### 根据挂号ID生成收费单

```http
[POST]/charge_order_service/wechat/pay_book
```

说明：
根据挂号id 生成待收费订单

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |

#### 影响的表

租户收费订单表(com_tena_trade)
租户收费订单子表(com_tena_tradeitem)

#### 请求报文参数

| 参数名           | 类型       | 必填   | 说明    |
| ------------- | -------- | ---- | ----- |
| book_id | String   | 是   |  挂号id    |


#### 回复报文参数

| 参数名     | 类型   | 必填   | 说明     |
| ------- | ---- | ---- | ------ |
| trad_id | Long | 是    | 退费订单ID |



### 根据收费订单ID获取支付参数

```http
[GET]/charge_order_service/wechat/get_pay_para
```

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |


#### 请求报文参数

| 参数名           | 类型       | 必填   | 说明    |
| ------------- | -------- | ---- | ----- |
| trad_id | Long | 是    | 退费订单ID |


#### 回复报文参数

| 参数名     | 类型   | 必填   | 说明     |
| ------- | ---- | ---- | ------ |
|  | 参数1 |     |  |
|  | 参数2 |     |  |


### 根据支付参数支付

```http
[POST]/charge_order_service/wechat/pay_trade
```

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.4 | 新增   |


#### 请求报文参数

| 参数名           | 类型       | 必填   | 说明    |
| ------------- | -------- | ---- | ----- |
| trad_id | Long | 是    | 退费订单ID |
|  | 参数1 |     |  |
|  | 参数2 |     |  |

#### 回复报文参数

| 参数名     | 类型   | 必填   | 说明     |
| ------- | ---- | ---- | ------ |
| 无 |  |     |  |

