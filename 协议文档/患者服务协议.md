#患者服务协议



##微信公众号



###微信配置基本信息获取

> [GET]/pati_service/wechat/conf

####修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |

####相关表

租户微信平台对接表(bas_tenant_wechat_mp)

#### 请求报文参数


| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |


#### 回复报文参数

| 参数名        | 类型     | 必填   | 说明        |
| ---------- | ------ | ---- | --------- |
| app_id     | String | 是    | appid     |
| app_secret | String | 是    | AppSecret |
| auth_url   | String | 是    | 网页授权域名地址  |


###微信配置基本信息保存

> [POST]/pati_service/wechat/conf

####修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |

####相关表

租户微信平台对接表(bas_tenant_wechat_mp)

#### 请求报文参数


| 参数名        | 类型     | 必填   | 说明        |
| ---------- | ------ | ---- | --------- |
| app_id     | String | 是    | appid     |
| app_secret | String | 是    | AppSecret |
| auth_url   | String | 是    | 网页授权域名地址  |


#### 回复报文参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |


### 微信配置菜单对应url获取

> [GET]/pati_service/wechat/menu_url

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |
| V1.3.9.2.1 | 新增聊天的地址   |

#### 相关表



#### 请求报文参数


| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |


#### 回复报文参数

| 参数名                 | 类型     | 必填   | 说明     |
| ------------------- | ------ | ---- | ------ |
| book_url            | String | 是    | 预约挂号地址 |
| personal_center_url | String | 是    | 个人中心地址 |
| chat_url            | String | 是    | 聊天地址 |


### 微信配置消息模板ID获取

> [GET]/pati_service/wechat/template_id

#### 修改更新记录

| 对应版本     | 说明                                    |
| -------- | ------------------------------------- |
| V1.3.3.2 | 新增                                    |
| V1.3.6   | 新增 3-挂号成功提醒 4 复诊提醒 5 医生回复提醒 6加工订单进度提醒 |

#### 
相关表

租户微信模板消息表(bas_tenant_wechat_template)

#### 请求报文参数


| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |



#### 回复报文参数

| 参数名            | 类型      | 必填   | 说明                                       |
| -------------- | ------- | ---- | ---------------------------------------- |
| wech_temp_type | Integer | 是    | 模板消息类型 0-取镜通知1-预约挂号成功通知2-预约挂号取消通知 3-挂号成功提醒 4 复诊提醒 5 医生回复提醒 6加工订单进度提醒 |
| wech_temp_id   | String  | 是    | 微信模板ID                                   |


###微信配置消息模板ID保存

> [POST]/pati_service/wechat/template_id

####修改更新记录

| 对应版本     | 说明                                    |
| -------- | ------------------------------------- |
| V1.3.3.2 | 新增                                    |
| V1.3.6   | 新增 3-挂号成功提醒 4 复诊提醒 5 医生回复提醒 6加工订单进度提醒 |

####相关表

租户微信模板消息表(bas_tenant_wechat_template)

#### 请求报文参数

| 参数名            | 类型      | 必填   | 说明                                       |
| -------------- | ------- | ---- | ---------------------------------------- |
| wech_temp_type | Integer | 是    | 模板消息类型 0-取镜通知1-预约挂号成功通知2-预约挂号取消通知 3-挂号成功提醒 4 复诊提醒 5 医生回复提醒 6加工订单进度提醒 |
| wech_temp_id   | String  | 是    | 微信模板ID                                   |

#### 回复报文参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |




###微信配置网页授权文件下载

> [GET]/pati_service/wechat/auth_file/download

####修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |

####相关表

租户微信网页授权认证文件表(bas_tenant_wechat_webauth)

#### 请求报文参数


| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |


#### 回复报文参数

| 参数名         | 类型   | 必填   | 说明   |
| ----------- | ---- | ---- | ---- |
| inputstream |      |      |      |


###微信配置网页授权文件上传

> [POST]/pati_service/wechat/auth_file/upload

####修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |

####相关表

租户微信网页授权认证文件表(bas_tenant_wechat_webauth)

#### 请求报文参数

| 参数名         | 类型   | 必填   | 说明   |
| ----------- | ---- | ---- | ---- |
| inputstream |      |      |      |


#### 回复报文参数


| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |


### 微信配置消息模板获取

> [GET]/pati_service/wechat/templates

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.3.2 | 新增   |

#### 请求报文参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

#### 回复报文参数

| 参数名          | 类型         | 必填   | 说明          |
| ------------ | ---------- | ---- | ----------- |
| templateList | ObjectList | 是    | 微信公众号消息模板列表 |

微信公众号消息模板列表

| 参数名             | 类型     | 必填   | 说明          |
| --------------- | ------ | ---- | ----------- |
| templateId      | String | 是    | 微信模板ID      |
| title           | String | 是    | 模板标题        |
| primaryIndustry | String | 是    | 模板所属行业的一级行业 |
| deputyIndustry  | String | 是    | 模板所属行业的二级行业 |
| content         | String | 是    | 模板内容        |
| example         | String | 是    | 模板实例        |


##患者认证


#### 患者注册获取手机验证码

>[GET]/pati_service/patient_service/register/phone_identifying_code


##### 入参说明

| 参数名   | 类型     | 必填   | 说明   |
| ----- | ------ | ---- | ---- |
| phone | String | 是    | 手机号  |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

#### 患者注册

>[POST]/pati_service/patient_service/register

##### 入参说明

| 参数名      | 类型     | 必填   | 说明   |
| -------- | ------ | ---- | ---- |
| phone    | String | 是    | 手机号  |
| verCode  | String | 是    | 验证码  |
| password | String | 是    | 密码   |

##### 回复参数

| 参数名    | 类型     | 必填   | 说明                    |
| ------ | ------ | ---- | --------------------- |
| userId | String | 是    | 用户ID                  |
| token  | String | 是    | 注册成功后直接登录，所以这里返回token |

#### 患者忘记密码，获取手机验证码

>[GET]/pati_service/patient_service/reset_password/phone_identifying_code

##### 入参说明

| 参数名   | 类型     | 必填   | 说明   |
| ----- | ------ | ---- | ---- |
| phone | String | 是    | 手机号  |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

#### 患者忘记密码，手机验证码验证

>[POST]/pati_service/patient_service/reset_password/phone_identifying_code_validate

##### 入参说明

| 参数名     | 类型     | 必填   | 说明   |
| ------- | ------ | ---- | ---- |
| phone   | String | 是    | 手机号  |
| verCode | String | 是    | 验证码  |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

#### 患者重置密码，通过手机验证码重置密码

>[POST]/pati_service/patient_service/reset_password

##### 入参说明

| 参数名         | 类型     | 必填   | 说明   |
| ----------- | ------ | ---- | ---- |
| phone       | String | 是    | 手机号  |
| verCode     | String | 是    | 验证码  |
| newPassword | String | 是    | 新密码  |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明            |
| ---- | ---- | ---- | ------------- |
| 无    |      |      | 重置密码成功后需要重新登录 |

#### 患者登录

>[POST]/pati_service/patient_service/login

##### 入参说明

| 参数名      | 类型     | 必填   | 说明   |
| -------- | ------ | ---- | ---- |
| phone    | String | 是    | 手机号  |
| password | String | 是    | 密码   |

##### 回复参数

| 参数名    | 类型     | 必填   | 说明           |
| ------ | ------ | ---- | ------------ |
| userId | String | 是    | 用户ID         |
| token  | String | 是    | 登录成功后返回token |

#### 患者修改密码，通过老密码修改密码

>[POST]/pati_service/patient_service/change_password

##### 入参说明

| 参数名         | 类型     | 必填   | 说明   |
| ----------- | ------ | ---- | ---- |
| oldPassword | String | 是    | 旧密码  |
| newPassword | String | 是    | 新密码  |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明          |
| ---- | ---- | ---- | ----------- |
| 无    |      |      | 修改成功后无需重新登录 |

#### 患者退出登录

>[POST]/pati_service/patient_service/logout

##### 入参说明

| 参数名  | 类型   | 必填   | 说明               |
| ---- | ---- | ---- | ---------------- |
| 无    |      |      | 请求header中会带token |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明          |
| ---- | ---- | ---- | ----------- |
| 无    |      |      | 退出成功后跳转登录页面 |

##预约挂号


#### 科室列表

>[GET]/pati_service/tenant_service/depts

####修改更新记录

| 对应版本   | 说明             |
| ------ | -------------- |
| V1.3.5 | 新增  预约科室展示时不分级 |

##### 入参说明

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

##### 回复参数ObjectList

| 参数名      | 类型     | 必填   | 说明   |
| -------- | ------ | ---- | ---- |
| deptId   | String | 是    | 科室ID |
| deptName | String | 是    | 科室名  |


#### 科室按日期排班列表

>[GET]/pati_service/tenant_service/schedule_by_date

##### 入参说明

| 参数名      | 类型      | 必填   | 说明                         |
| -------- | ------- | ---- | -------------------------- |
| deptId   | String  | 是    | 科室ID                       |
| date     | Date    | 是    | 日期，时间格式参考《全局约定.md》         |
| pageNo   | Integer | 否    | 分页页码，需要一个大于0的数字，可以不传，默认为1  |
| pageSize | Integer | 否    | 每页数量，需要一个大于0的数字，可以不传，默认为10 |

##### 回复参数(Page)

| 参数名          | 类型      | 必填   | 说明                 |
| ------------ | ------- | ---- | ------------------ |
| doctorId     | String  | 是    | 医生ID               |
| doctorName   | String  | 是    | 医生姓名               |
| doctorAvatar | String  | 是    | 医生头像               |
| doctorTitle  | String  | 否    | 医生职称               |
| doctorDesp   | String  | 是    | 医生介绍               |
| deptId       | String  | 是    | 科室ID               |
| deptName     | String  | 是    | 科室名                |
| deptAvatar   | String  | 是    | 科室头像               |
| deptDesp     | String  | 是    | 科室介绍               |
| date         | Date    | 是    | 日期，时间格式参考《全局约定.md》 |
| type         | Integer | 是    | 挂号类型，0 普通， 1 专家    |
| status       | Integer | 是    | 号源状态，1 可约， 2 约满    |
| bookfee      | Double  | 是    | 挂号费用               |

#### 科室按医生排班列表

>[GET]/pati_service/tenant_service/schedule_by_doctor

##### 入参说明

| 参数名      | 类型      | 必填   | 说明                         |
| -------- | ------- | ---- | -------------------------- |
| deptId   | String  | 是    | 科室ID                       |
| pageNo   | Integer | 否    | 分页页码，需要一个大于0的数字，可以不传，默认为1  |
| pageSize | Integer | 否    | 每页数量，需要一个大于0的数字，可以不传，默认为10 |

##### 回复参数(Page)

| 参数名          | 类型      | 必填   | 说明                     |
| ------------ | ------- | ---- | ---------------------- |
| doctorId     | String  | 是    | 医生ID，返回医生时使用doctor相关字段 |
| doctorName   | String  | 是    | 医生名                    |
| doctorAvatar | String  | 是    | 医生头像                   |
| doctorTitle  | String  | 是    | 医生职称                   |
| doctorDesp   | String  | 是    | 医生介绍                   |
| deptId       | String  | 是    | 科室ID，返回科室时使用dept相关字段   |
| deptName     | String  | 是    | 科室名字                   |
| deptPortrait | String  | 是    | 科室头像                   |
| deptDesp     | String  | 是    | 科室介绍                   |
| status       | Integer | 是    | 号源状态，1 可约， 2 约满        |

#### 具体医生某天的挂号情况

>[GET]/pati_service/tenant_service/schedule

分上午下午 返回上/下午的号源详情

##### 入参说明

| 参数名      | 类型     | 必填   | 说明                      |
| -------- | ------ | ---- | ----------------------- |
| doctorId | String | 否    | 医生ID，科室的普通门诊该值传空        |
| deptId   | String | 是    | 科室ID                    |
| date     | Date   | 否    | 日期，格式参考《全局约定.md》，不传表示当天 |
| V1.3.6   | 新增     |      | 候诊地点                    |
##### 回复参数

| 参数名        | 类型     | 必填   | 说明                 |
| ---------- | ------ | ---- | ------------------ |
| date       | Date   | 是    | 日期，时间格式参考《全局约定.md》 |
| scheduleAM | Object | 是    | 上午挂号情况，null表示不出诊   |
| schedulePM | Object | 是    | 下午挂号情况，null表示不出诊   |

挂号情况对象结构

| 参数名         | 类型      | 必填   | 说明                   |
| ----------- | ------- | ---- | -------------------- |
| scheduleId  | String  | 是    | 排班ID                 |
| type        | Integer | 是    | 挂号类型， 0 普通门诊， 1 专家门诊 |
| bookfee     | Double  | 是    | 挂号费用                 |
| leftCount   | Integer | 是    | 剩余可预约号源数量            |
| scheAdderss | String  | 是    | 候诊地点                 |
#### 排班剩余号源详情

>[GET]/pati_service/tenant_service/schedule/left_appo

##### 入参说明

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| scheduleId | String | 是    | 排班ID |

##### 回复参数(ObjectList)

| 参数名      | 类型      | 必填   | 说明           |
| -------- | ------- | ---- | ------------ |
| serialNo | Integer | 是    | 序号           |
| time     | String  | 是    | 预约时间，类似09:00 |

#### 医生基本信息以及明天起指定天数内每天的可挂号数

>[GET]/pati_service/tenant_service/schedule/info

##### 入参说明

| 参数名      | 类型      | 必填   | 说明               |
| -------- | ------- | ---- | ---------------- |
| doctorId | String  | 否    | 医生ID，科室的普通门诊该值传空 |
| deptId   | String  | 是    | 科室ID             |
| days     | Integer | 否    | 需要返回的天数，不传默认为7天  |

##### 回复参数(ObjectList)

| 参数名               | 类型         | 必填   | 说明          |
| ----------------- | ---------- | ---- | ----------- |
| doctorId          | String     | 否    | 医生ID        |
| doctorName        | String     | 否    | 医生名         |
| doctorPortrait    | String     | 否    | 医生头像        |
| doctorTitle       | String     | 否    | 医生职称        |
| doctorDesp        | String     | 否    | 医生介绍        |
| deptId            | String     | 是    | 科室ID        |
| deptName          | String     | 是    | 科室名字        |
| deptPortrait      | String     | 是    | 科室头像        |
| deptDesp          | String     | 是    | 科室介绍        |
| leftBookCountList | ObjectList | 是    | 日期-剩余可挂号数列表 |

日期-剩余可挂号数对象结构

| 参数名       | 类型      | 必填   | 说明                             |
| --------- | ------- | ---- | ------------------------------ |
| date      | Date    | 是    | 日期，格式参考《全局约定.md》，没有返回的日期表示没有排班 |
| leftCount | Integer | 是    | 剩余号源数，0表示已满                    |

#### 挂号预提交

>[POST]/pati_service/book_service/book/presubmit

##### 入参说明

| 参数名        | 类型      | 必填   | 说明                     |
| ---------- | ------- | ---- | ---------------------- |
| scheduleId | String  | 是    | 排班ID                   |
| serialNo   | Integer | 是    | 就诊编号，例如"10号 10:00"就传10 |

##### 回复参数

| 参数名      | 类型       | 必填   | 说明                     |
| -------- | -------- | ---- | ---------------------- |
| deptId   | String   | 是    | 预约科室ID                 |
| deptName | String   | 是    | 预约科室名                  |
| type     | Integer  | 是    | 挂号类型，0 普通门诊， 1 专家门诊    |
| doctor   | String   | 否    | 医生姓名，如果为null，表示科室的普通门诊 |
| appoTime | DateTime | 是    | 就诊时间，时间格式参考《全局约定.md》   |
| bookfee  | Double   | 是    | 挂号费用                   |

#### 预约挂号

>[POST]/pati_service/book_service/book/submit

##### 入参说明

| 参数名        | 类型      | 必填   | 说明                     |
| ---------- | ------- | ---- | ---------------------- |
| scheduleId | String  | 是    | 排班ID                   |
| serialNo   | Integer | 是    | 就诊编号，例如"10号 10:00"就传10 |
| memberId   | String  | 是    | 就诊人ID                  |

##### 回复参数

| 参数名    | 类型     | 必填   | 说明             |
| ------ | ------ | ---- | -------------- |
| bookId | String | 是    | 预约挂号成功后，返回预约ID |


#### 预约记录列表

>[GET]/pati_service/book_service/books

##### 入参说明

| 参数名      | 类型      | 必填   | 说明                         |
| -------- | ------- | ---- | -------------------------- |
| pageNo   | Integer | 否    | 分页页码，需要一个大于0的数字，可以不传，默认为1  |
| pageSize | Integer | 否    | 每页数量，需要一个大于0的数字，可以不传，默认为10 |

##### 回复参数(Page)

| 参数名          | 类型       | 必填   | 说明                           |
| ------------ | -------- | ---- | ---------------------------- |
| bookId       | String   | 是    | 预约记录ID                       |
| treaTime     | DateTime | 是    | 就诊时间，时间格式参考《全局约定.md》         |
| bookStatus   | Integer  | 是    | 预约状态，0:已预约;1:已取消;2:已挂号;3:已失约 |
| deptId       | String   | 是    | 科室ID                         |
| deptName     | String   | 是    | 科室名                          |
| type         | Integer  | 是    | 挂号类型， 0 普通门诊， 1 专家门诊         |
| doctorId     | String   | 否    | 医生ID，如果是普通门诊，可能为空            |
| doctorName   | String   | 否    | 医生名字，如果是普通门诊，可能为空            |
| memberName   | String   | 是    | 就诊人名字                        |
| visiSerialno | String   | 否    | 患者就诊序号                       |
| visiCharge   | Integer  | 否    | 收费状态    1未收费 2 已收费           |
#### 预约记录明细

>[GET]/pati_service/book_service/book/{bookId}

#### 修改更新记录

| 对应业务      | 说明           |
| --------- | ------------ |
| WEBV1.3.6 | 实现修改 增加性别和年龄 |

##### 入参说明

| 参数名    | 类型     | 必填   | 说明     |
| ------ | ------ | ---- | ------ |
| bookId | String | 是    | 预约记录ID |

##### 回复参数

| 参数名          | 类型       | 必填   | 说明                           |
| ------------ | -------- | ---- | ---------------------------- |
| bookId       | String   | 是    | 预约记录ID                       |
| bookCode     | String   | 是    | 预约号                          |
| bookStatus   | Integer  | 是    | 预约状态，0:已预约;1:已取消;2:已挂号;3:已失约 |
| deptId       | String   | 是    | 科室ID                         |
| deptName     | String   | 是    | 科室名                          |
| type         | Integer  | 是    | 挂号类型， 0 普通门诊， 1 专家门诊         |
| doctorId     | String   | 否    | 医生ID，如果是普通门诊，可能为空            |
| doctorName   | String   | 否    | 医生名字，如果是普通门诊，可能为空            |
| bookfee      | Double   | 是    | 挂号费用                         |
| treaTime     | DateTime | 是    | 就诊时间，预约的号源时间                 |
| treaNo       | Integer  | 是    | 就诊序号                         |
| treaArea     | String   | 是    | 候诊区域                         |
| memberName   | String   | 是    | 就诊人名字                        |
| memberGender | String   | 是    | 就诊人性别                        |
| memberAge    | String   | 是    | 就诊人年龄                        |
| memberIDNo   | String   | 是    | 就诊人身份证号，中间隐藏由前端实现            |
| bookTime     | DateTime | 是    | 预约时间，时间格式参考《全局约定.md》         |
| visiCharge   | Integer  | 否    | 收费状态    1未收费 2 已收费           |
#### 取消预约挂号

>[POST]/pati_service/book_service/book/cancel

##### 入参说明

| 参数名    | 类型     | 必填   | 说明         |
| ------ | ------ | ---- | ---------- |
| bookId | String | 是    | 要取消的预约记录ID |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |



##就诊人和我

#### 添加就诊人

>[POST]/pati_service/patient_service/member

##### 入参说明

| 参数名      | 类型      | 必填   | 说明                   |
| -------- | ------- | ---- | -------------------- |
| name     | String  | 是    | 就诊人姓名                |
| gender   | Integer | 是    | 性别，参考《全局约定.md》       |
| birthday | Date    | 是    | 出生日期，时间格式参考《全局约定.md》 |
| IDNo     | String  | 是    | 身份证号码                |
| phone    | String  | 是    | 手机号                  |

##### 回复参数

| 参数名      | 类型     | 必填   | 说明           |
| -------- | ------ | ---- | ------------ |
| memberId | String | 是    | 添加成功后返回就诊人ID |

#### 就诊人列表

>[GET]/pati_service/patient_service/members

####修改更新记录

| 对应版本   | 说明     |
| ------ | ------ |
| V1.3.5 | 增加患者ID |

##### 入参说明

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

##### 回复参数

| 参数名        | 类型      | 必填   | 说明             |
| ---------- | ------- | ---- | -------------- |
| memberId   | String  | 是    | 就诊人ID          |
| bindPatiId | String  | 是    | 患者ID           |
| name       | String  | 是    | 就诊人姓名          |
| gender     | Integer | 是    | 性别，参考《全局约定.md》 |
| age        | String  | 是    | 年龄             |
| IDNo       | String  | 是    | 身份证号码          |
| phone      | String  | 是    | 手机号            |


#### 获取我的个人信息

>[GET]/pati_service/patient_service/myinfo

##### 入参说明

| 参数名    | 类型   | 必填          | 说明   |
| ------ | ---- | ----------- | ---- |
| V1.3.6 | 新增   | 年龄，条形码，患者ID |      |

##### 回复参数

| 参数名      | 类型      | 必填   | 说明                   |
| -------- | ------- | ---- | -------------------- |
| phone    | String  | 是    | 手机号，中间四位隐藏由前端实现      |
| avatar   | String  | 是    | 头像URL                |
| name     | String  | 是    | 昵称                   |
| gender   | Integer | 是    | 性别，参考《全局约定.md》       |
| birthday | Date    | 是    | 出生日期，时间格式参考《全局约定.md》 |
| age      | String  | 是    | 年龄                   |
| pati_img | String  | 是    | 条形码                  |
| pati_id  | String  | 患者ID | 性别，参考《全局约定.md》       |
#### 更新我的个人信息

>[POST]/pati_service/patient_service/myinfo

##### 入参说明

| 参数名      | 类型      | 必填   | 说明                   |
| -------- | ------- | ---- | -------------------- |
| name     | String  | 是    | 昵称                   |
| gender   | Integer | 是    | 性别，参考《全局约定.md》       |
| birthday | Date    | 是    | 出生日期，时间格式参考《全局约定.md》 |

##### 回复参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

### 微信用户信息条形码查询

> [GET]/pati_service/wechat/query_bar_code

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.1.3.6 | 新增   |

#### 请求报文参数

| 参数名       | 类型   | 必填   | 说明   |
| --------- | ---- | ---- | ---- |
| member_id | Long | 是    | 就诊人  |

#### 回复报文参数

| 参数名         | 类型   | 必填   | 说明   |
| ----------- | ---- | ---- | ---- |
| inputStream |      | 是    | 条形码  |

#### 就诊人列表

>[GET]/pati_service/patient_service/members

| 对应版本   | 说明              |
| ------ | --------------- |
| V1.3.6 | 添加 患者IDBase64字符 |

##### 入参说明

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

##### 回复参数

| 参数名           | 类型      | 必填   | 说明             |
| ------------- | ------- | ---- | -------------- |
| memberId      | String  | 是    | 就诊人ID          |
| name          | String  | 是    | 就诊人姓名          |
| gender        | Integer | 是    | 性别，参考《全局约定.md》 |
| age           | String  | 是    | 年龄             |
| IDNo          | String  | 是    | 身份证号码          |
| phone         | String  | 是    | 手机号            |
| defaultMember | Bool    | 是    | 默认就诊人          |
| patiImg       | String  | 是    | 患者IDBase64字符   |
| bindPatiId    | String  | 是    | 绑定患者ID         |

#### 预约须知和客服热线

>[GET]/pati_service/wechat/service_info

| 对应版本   | 说明   |
| ------ | ---- |
| V1.3.6 | 新增   |

##### 入参说明

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

##### 回复参数

| 参数名         | 类型     | 必填   | 说明   |
| ----------- | ------ | ---- | ---- |
| appo_notice | String | 是    | 预约须知 |
| phone       | String | 是    | 客服热线 |

### 根据预约ID创建收费结算单同时调用微信统一支付协议进行下单

```http
[POST]/pati_service/book_service/pay/appo_order
```

说明：
根据预约id生产挂号收费单和结算单,并调用微信统一支付协议进行下单

#### 修改更新记录

| 对应业务  | 说明   |
| ----- | ---- |
| 1.3.6 | 新增   |


#### 请求报文参数

| 参数名     | 类型     | 必填   | 说明             |
| ------- | ------ | ---- | -------------- |
| appo_id | long   | 是    | 预约id           |
| open_id | String | 是    | 微信用户对应公众号的唯一ID |


#### 回复报文参数

| 参数名          | 类型      | 必填   | 说明                                       |
| ------------ | ------- | ---- | :--------------------------------------- |
| is_success   | boolean | 是    | 请求是否成功，真正业务成功需要看error_code               |
| trade_type   | String  | 是    | JSAPI:公众号支付 NATIVE:原生扫码支付 APP:App支付 MWEB:h5页面支付 |
| prepay_id    | String  | 是    | //微信生成的预支付会话标识，用于后续接口调用中使用，该值有效期为2小时     |
| trade_no     | String  | 否    | 交易号                                      |
| out_trade_no | String  | 是    | 交易订单号                                    |
| url          | String  | 是    | 支付地址                                     |
| error_code   | String  | 是    | SUCCESS表示成功，FAIL表示失败                     |
| error_msg    | String  | 否    | 错误信息                                     |
| nonce_str    | String  | 是    | 生成签名的随机串                                 |
| sign_type    | String  | 是    | 签名方式                                     |
| agency_id    | String  | 是    | 运营机构ID                                   |
| timestamp    | String  | 是    | 生成签名的时间戳                                 |

### 用户个人图像上传

```http
[POST]/pati_service/patient_service/myinfo/upload_picture
```

说明：
  获取oss地址，文件名等信息

#### 修改更新记录

| 对应业务      | 说明   |
| --------- | ---- |
| Web 1.3.6 | 新增   |

#### 请求报文参数

| 参数名            | 类型     | 必填   | 说明                |
| -------------- | ------ | ---- | ----------------- |
| file_size      | Long   | 否    | 文件内容长度            |
| file_extension | String | 是    | 文件扩展名(不带“.“)      |
| file_type      | String | 是    | 文件类型，Content-Type |


#### 回复报文参数

| 参数名               | 类型     | 必填   | 说明                       |
| ----------------- | ------ | ---- | ------------------------ |
| url               | String | 是    | 文件上传的oss的URL             |
| file_id           | Long   | 是    | 文件资源id                   |
| OSS_access_key_id | String | 是    | Bucket 拥有者的Access Key Id |
| policy            | String | 是    | Base64编码的JSON内容          |
| signature         | String | 是    | 签名                       |
| key               | String | 是    | 上传文件路径                   |

### 获取微信公众号jsapiSinature信息

```url
[POST]/pati_service/wx/jsapi/signature
```

说明：
1. 获取微信公众号jsapiSinature信息

#### 修改更新记录

| 对应业务        | 说明   |
| ----------- | ---- |
| WEBV1.3.6.1 | 新增   |

#### 请求报文参数

#### RequestHeader

| 参数名      | 类型   | 必填   | 说明   |
| -------- | ---- | ---- | ---- |
| tenantId | Long | 是    | 租户ID |

#### RequestBody
| 参数名  | 类型     | 必填   | 说明       |
| ---- | ------ | ---- | -------- |
| url  | String | 是    | 当前页面的url |

#### 回复报文参数

| 参数名       | 类型     | 必填   | 说明       |
| --------- | ------ | ---- | -------- |
| appId     | String | 是    | 公众号的唯一标识 |
| nonceStr  | String | 是    | 生成签名的随机串 |
| timestamp | String | 是    | 生成签名的时间戳 |
| url       | String | 是    | 当前页面的url |
| signature | String | 是    | 签名       |


### 微信js-sdk支付签名获取

```http
[POST]/pati_service/wx/jsapi/paysign
```

说明：
1. 微信js-sdk支付签名获取

#### 修改更新记录

| 对应业务      | 说明   |
| --------- | ---- |
| WEBV1.3.6 | 新增   |

#### 影响的表


#### 请求报文参数

| 参数名       | 类型     | 必填   | 说明           |
| --------- | ------ | ---- | ------------ |
| agencyId  | Long   | 是    | 运营机构         |
| tenantId  | Long   | 是    | 租户id         |
| appId     | Long   | 是    | 公众号id        |
| timeStamp | String | 是    | 时间戳，秒级       |
| nonceStr  | String | 是    | 随机字符串        |
| prepayId  | String | 是    | 微信生成的预支付会话标识 |
| signType  | String | 是    | 签名类型         |

#### 回复报文参数

| 参数名     | 类型     | 必填   | 说明        |
| ------- | ------ | ---- | :-------- |
| paySign | String | 是    | 生成用于支付的签名 |




### 查询患者服务分组或标签(带人数)

> [[GET]/pati_service/manager_service/list_person_count]

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

####相关表

患者服务分组标签表(adm_group_label、adm_pati_label_rela)

#### 请求报文参数


| 参数名        | 类型      | 必填   | 说明                    |
| ---------- | ------- | ---- | --------------------- |
| page_size  | Integer | 否    | 每页条数  空表示查询全部         |
| page_num   | Integer | 否    | 第几页      空表示查询全部      |
| label_type | Integer | 是    | 1表示分组   2表示标签         |
| order_type | Integer | 是    | 1表示按照序号升序   2表示按照序号降序 |
#### 回复报文参数

| 参数名            | 类型         | 必填   | 说明    |
| -------------- | ---------- | ---- | ----- |
| page_num       | Integer    | 是    | 当前页   |
| page_size      | Integer    | 是    | 每页的数量 |
| total          | Integer    | 是    | 总记录数  |
| pages          | Integer    | 是    | 总页数   |
| person_numbers | Integer    | 是    | 总人数   |
| list           | ObjectList | 是    | 列表    |

列表说明

| 参数名           | 类型      | 必填   | 说明       |
| ------------- | ------- | ---- | -------- |
| label_name    | String  | 是    | 分组或者标签名称 |
| label_id      | String  | 是    | 分组或者标签编码 |
| user_name     | String  | 是    | 录入人      |
| person_number | Integer | 是    | 统计人数     |
| create_time   | Long    | 是    | 创建时间     |


### 查询患者服务分组或标签

> [[GET]/pati_service/manager_service/list]

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

#### 请求报文参数


| 参数名        | 类型      | 必填   | 说明            |
| ---------- | ------- | ---- | ------------- |
| label_type | Integer | 是    | 1表示分组   2表示标签 |

#### 回复报文参数

| 参数名  | 类型         | 必填   | 说明   |
| ---- | ---------- | ---- | ---- |
| list | ObjectList | 是    | 列表   |

列表说明

| 参数名        | 类型     | 必填   | 说明       |
| ---------- | ------ | ---- | -------- |
| label_name | String | 是    | 分组或者标签名称 |
| label_id   | String | 是    | 分组或者标签编码 |



### 新增和修改患者服务分组和标签

> [[POST]/pati_service/manager_service/save_group_label]

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

#### 请求报文参数


| 参数名        | 类型      | 必填   | 说明                  |
| ---------- | ------- | ---- | ------------------- |
| label_name | String  | 是    | 分组或者标签              |
| label_id   | String  | 否    | 分组或者标签 空表示新增 有值代表修改 |
| label_type | Integer | 是    | 1为分组 2为标签           |
#### 回复报文参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |



### 删除患者服务分组和标签

> [[POST]/pati_service/manager_service/del_group_label]

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

#### 参数


| 参数名        | 类型      | 必填   | 说明        |
| ---------- | ------- | ---- | --------- |
| label_id   | String  | 是    | 分组或者标签    |
| label_type | Integer | 是    | 1为分组 2为标签 |
#### 回复报文参数

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |



### 查询患者信息

> [[GET]/pati_service/manager_service/pati_info]

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

#### 参数

| 参数名     | 类型     | 必填   | 说明   |
| ------- | ------ | ---- | ---- |
| pati_id | String | 是    | 患者ID |
#### 回复报文参数

| 参数名                 | 类型         | 必填   | 说明                   |
| ------------------- | ---------- | ---- | -------------------- |
| pati_id             | String     | 是    | 患者ID                 |
| pati_name           | String     | 是    | 患者姓名                 |
| pati_gender         | Integer    | 否    | 性别 性别代码 0 未知 1男  2 女 |
| pati_birthday       | String     | 否    | 出身日期                 |
| pati_age            | String     | 否    | 年龄                   |
| pati_phone          | String     | 否    | 电话                   |
| pati_create_time    | String     | 否    | 建档日期                 |
| pati_group_id       | String     | 否    | 分组id                 |
| pati_group_name     | String     | 否    | 分组名称                 |
| list                | ObjectList | 否    | 标签列表                 |
| pati_id_type        | String     | 否    | 证件类型                 |
| pati_id_number      | String     | 否    | 证件号码                 |
| pati_province       | String     | 否    | 省                    |
| pati_city           | String     | 否    | 市                    |
| pati_county         | String     | 否    | 区县                   |
| pati_address        | String     | 否    | 详细地址                 |
| pati_splice_address | String     | 否    | 组合地址                 |
| cont_name           | String     | 否    | 联系人                  |
| cont_relation       | Integer    | 否    | 关系                   |
| cont_phone          | String     | 否    | 联系人电话                |
| pati_photo          | String     | 否    | 患者头像                 |
| trea_id             | String     | 否    | 患者就诊ID               |
list列表说明

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| label_name | String | 是    | 标签名称 |
| label_id   | String | 是    | 标签编码 |

### 患者服务建档

> [[POST]/pati_service/manager_service/patient

#### 修改更新记录

| 对应版本     | 说明   |
| -------- | ---- |
| V1.3.9.1 | 新增   |

#### 请求报文参数

| 参数名            | 类型         | 必填   | 说明                  |
| -------------- | ---------- | ---- | ------------------- |
| pati_id        | Long       | 是    | 患者ID 为空表示新增 有数据表示修改 |
| pati_name      | String     | 是    | 姓名                  |
| pati_gender    | String     | 是    | 性别代码 0 未知 1男  2 女   |
| pati_birthday  | Date       | 是    | 出生年月                |
| pati_phone     | String     | 是    | 手机号码                |
| pati_id_type   | String     | 否    | 证件类型 99 身份证         |
| pati_id_number | String     | 否    | 证件号码                |
| pati_province  | String     | 否    | 省                   |
| pati_city      | String     | 否    | 市                   |
| pati_county    | String     | 否    | 区县                  |
| pati_address   | String     | 否    | 详细地址                |
| cont_name      | String     | 否    | 联系人                 |
| cont_relation  | Integer    | 否    | 关系                  |
| cont_phone     | String     | 否    | 联系人电话               |
| pati_group_id  | String     | 否    | 分组                  |
| list           | ObjectList | 否    | 标签列表                |

#### 回复报文参数Object

| 参数名        | 类型     | 必填   | 说明   |
| ---------- | ------ | ---- | ---- |
| label_name | String | 是    | 标签名称 |
| label_id   | String | 是    | 标签编码 |


### 患者同一时间段就诊判断

```http
[POST]/pati_service/book_service/book/schedule
```
#### 修改更新记录

| 对应版本        | 说明   |
| ----------- | ---- |
| PATV1.0.2.2 | 新增   |

#### 请求报文参数

| 参数名        | 类型     | 必填   | 说明    |
| ---------- | ------ | ---- | ----- |
| scheduleId | String | 是    | 排版ID  |
| memberId   | String | 是    | 就诊人ID |

#### 回复报文参数Object

| 参数名  | 类型   | 必填   | 说明   |
| ---- | ---- | ---- | ---- |
| 无    |      |      |      |

##医生列表（微信用）


### 咨询时医生列表

```http
[GET]/pati_service/manager_service/doctor_list
```
聊天时找医生，医生列表

#### 修改更新记录

| 对应业务         | 说明   |
| ------------ | ---- |
| PAT_V1.0.2.1 | 新增   |


#### 请求报文参数

| 参数名         | 类型      | 必填   | 说明        |
| ----------- | ------- | ---- | --------- |
| doctor_name | String  | 否    | 医生姓名 模糊查询 |
| page_num    | Integer | 是    | 当前页       |
| page_size   | Integer | 是    | 每页的数量     |

#### 回复报文参数ObjectList

医生列表说明
#### 回复报文参数

| 参数名       | 类型         | 必填   | 说明    |
| --------- | ---------- | ---- | ----- |
| page_num  | Integer    | 是    | 当前页   |
| page_size | Integer    | 是    | 每页的数量 |
| total     | Integer    | 是    | 总记录数  |
| pages     | Integer    | 是    | 总页数   |
| list      | ObjectList | 是    | 列表    |

#### 列表参数
| 参数名              | 类型     | 必填   | 说明      |
| ---------------- | ------ | ---- | ------- |
| doctor_id        | String | 是    | 医生id    |
| doctor_name      | String | 是    | 医生姓名    |
| doctor_photo_url | String | 是    | 医生头像url |
| doctor_title     | String | 是    | 医生职称    |
| doctor_expert    | String | 是    | 医生擅长    |